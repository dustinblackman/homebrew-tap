# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Oatmeal < Formula
  desc "Terminal UI to chat with large language models (LLM) using backends such as Ollama, and direct integrations with your favourite editor like Neovim!"
  homepage "https://github.com/dustinblackman/oatmeal"
  version "0.2.2"

  on_macos do
    if Hardware::CPU.arm?
      url "https://github.com/dustinblackman/oatmeal/releases/download/v0.2.2/oatmeal_0.2.2_darwin_arm64.tar.gz"
      sha256 "0015e2968a6366ee57f70665bad4a93ed39b9eb0afa1fa57b0aa556e9e5be6b9"

      def install
        # Install oatmeal
        bin.install "oatmeal"

        # Install shell completions
        output = Utils.safe_popen_read("#{bin}/oatmeal", "completions", "-s", "bash")
        (bash_completion/"oatmeal").write output

        output = Utils.safe_popen_read("#{bin}/oatmeal", "completions", "-s", "zsh")
        (zsh_completion/"_oatmeal").write output

        output = Utils.safe_popen_read("#{bin}/oatmeal", "completions", "-s", "fish")
        (fish_completion/"oatmeal.fish").write output
      end
    end
    if Hardware::CPU.intel?
      url "https://github.com/dustinblackman/oatmeal/releases/download/v0.2.2/oatmeal_0.2.2_darwin_amd64.tar.gz"
      sha256 "a6287271595a575e7b2d5cdd5a24647f10d38b4ff733e863e391f9dc3683ca69"

      def install
        # Install oatmeal
        bin.install "oatmeal"

        # Install shell completions
        output = Utils.safe_popen_read("#{bin}/oatmeal", "completions", "-s", "bash")
        (bash_completion/"oatmeal").write output

        output = Utils.safe_popen_read("#{bin}/oatmeal", "completions", "-s", "zsh")
        (zsh_completion/"_oatmeal").write output

        output = Utils.safe_popen_read("#{bin}/oatmeal", "completions", "-s", "fish")
        (fish_completion/"oatmeal.fish").write output
      end
    end
  end

  on_linux do
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url "https://github.com/dustinblackman/oatmeal/releases/download/v0.2.2/oatmeal_0.2.2_linux_arm64.tar.gz"
      sha256 "ef28dd38a1bacd16b0225b72eaa00cbf7896f6b7a279517678eb45cd382bade5"

      def install
        # Install oatmeal
        bin.install "oatmeal"

        # Install shell completions
        output = Utils.safe_popen_read("#{bin}/oatmeal", "completions", "-s", "bash")
        (bash_completion/"oatmeal").write output

        output = Utils.safe_popen_read("#{bin}/oatmeal", "completions", "-s", "zsh")
        (zsh_completion/"_oatmeal").write output

        output = Utils.safe_popen_read("#{bin}/oatmeal", "completions", "-s", "fish")
        (fish_completion/"oatmeal.fish").write output
      end
    end
    if Hardware::CPU.intel?
      url "https://github.com/dustinblackman/oatmeal/releases/download/v0.2.2/oatmeal_0.2.2_linux_amd64.tar.gz"
      sha256 "f3263351fd639b7a82d6c96ab647af0289ba879634ff4c65f6f3985fea1a10e5"

      def install
        # Install oatmeal
        bin.install "oatmeal"

        # Install shell completions
        output = Utils.safe_popen_read("#{bin}/oatmeal", "completions", "-s", "bash")
        (bash_completion/"oatmeal").write output

        output = Utils.safe_popen_read("#{bin}/oatmeal", "completions", "-s", "zsh")
        (zsh_completion/"_oatmeal").write output

        output = Utils.safe_popen_read("#{bin}/oatmeal", "completions", "-s", "fish")
        (fish_completion/"oatmeal.fish").write output
      end
    end
  end

  test do
    system "#{bin}/oatmeal --version"
  end
end
