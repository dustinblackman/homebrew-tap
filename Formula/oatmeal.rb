# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Oatmeal < Formula
  desc "Terminal UI to chat with large language models (LLM) using backends such as Ollama, and direct integrations with your favourite editor like Neovim!"
  homepage "https://github.com/dustinblackman/oatmeal"
  version "0.1.0"

  on_macos do
    if Hardware::CPU.arm?
      url "https://github.com/dustinblackman/oatmeal/releases/download/v0.1.0/oatmeal_0.1.0_darwin_arm64.tar.gz"
      sha256 "7c7801360b433b9de8f2ffbe1b288ed85c40c7942f2dba708446767c3da1e2bc"

      def install
        # Install oatmeal
        bin.install "oatmeal"

        # Install shell completions
        output = Utils.safe_popen_read("#{bin}/oatmeal", "completion", "-s", "bash")
        (bash_completion/"oatmeal").write output

        output = Utils.safe_popen_read("#{bin}/oatmeal", "completion", "-s", "zsh")
        (zsh_completion/"_oatmeal").write output

        output = Utils.safe_popen_read("#{bin}/oatmeal", "completion", "-s", "fish")
        (fish_completion/"oatmeal.fish").write output
      end
    end
    if Hardware::CPU.intel?
      url "https://github.com/dustinblackman/oatmeal/releases/download/v0.1.0/oatmeal_0.1.0_darwin_amd64.tar.gz"
      sha256 "75b7a2708fb24a225088f71de294ee27082b0e68fb4130b295ee161f1428e473"

      def install
        # Install oatmeal
        bin.install "oatmeal"

        # Install shell completions
        output = Utils.safe_popen_read("#{bin}/oatmeal", "completion", "-s", "bash")
        (bash_completion/"oatmeal").write output

        output = Utils.safe_popen_read("#{bin}/oatmeal", "completion", "-s", "zsh")
        (zsh_completion/"_oatmeal").write output

        output = Utils.safe_popen_read("#{bin}/oatmeal", "completion", "-s", "fish")
        (fish_completion/"oatmeal.fish").write output
      end
    end
  end

  on_linux do
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url "https://github.com/dustinblackman/oatmeal/releases/download/v0.1.0/oatmeal_0.1.0_linux_arm64.tar.gz"
      sha256 "5fed3cee32d0adf908c2e02022e5da0d96f4bca5ed0f2c69d6aee6d102f2f1fe"

      def install
        # Install oatmeal
        bin.install "oatmeal"

        # Install shell completions
        output = Utils.safe_popen_read("#{bin}/oatmeal", "completion", "-s", "bash")
        (bash_completion/"oatmeal").write output

        output = Utils.safe_popen_read("#{bin}/oatmeal", "completion", "-s", "zsh")
        (zsh_completion/"_oatmeal").write output

        output = Utils.safe_popen_read("#{bin}/oatmeal", "completion", "-s", "fish")
        (fish_completion/"oatmeal.fish").write output
      end
    end
    if Hardware::CPU.intel?
      url "https://github.com/dustinblackman/oatmeal/releases/download/v0.1.0/oatmeal_0.1.0_linux_amd64.tar.gz"
      sha256 "541842d6dc6d2201d7e55299f9f040727fdd2f3b25c7056f2f42df0f6bc536e1"

      def install
        # Install oatmeal
        bin.install "oatmeal"

        # Install shell completions
        output = Utils.safe_popen_read("#{bin}/oatmeal", "completion", "-s", "bash")
        (bash_completion/"oatmeal").write output

        output = Utils.safe_popen_read("#{bin}/oatmeal", "completion", "-s", "zsh")
        (zsh_completion/"_oatmeal").write output

        output = Utils.safe_popen_read("#{bin}/oatmeal", "completion", "-s", "fish")
        (fish_completion/"oatmeal.fish").write output
      end
    end
  end

  test do
    system "#{bin}/oatmeal --version"
  end
end
